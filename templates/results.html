{% extends "base.html" %}

{% block title %}Results for "{{ search_term }}"{% endblock %}

{% block content %}
    <h1>Results for "{{ search_term }}"</h1>
    <a href="/">‚Üê New Search</a>

    {% if results %}
        <p class="results-count">Found {{ results|length }} matches:</p>
        {% for filename, contexts in results %}
            <div class="file-container">
                <h2 class="file-title">
                    <a href="{{ url_for('show_file', filename=filename) }}">
                        {{ filename }} ({{ contexts|length }} matches)
                    </a>
                </h2>
                <hr>
                <div class="debug-info" style="display: none;">
                    <h3>Debug Information</h3>
                    <p>Results object type: {{ results|type }}</p>
                    <p>Results structure:</p>
                    <ul>
                        {% for filename, contexts in results %}
                            <li>
                                {{ filename|type }}: 
                                <ul>
                                    <li>{{ contexts|type }}</li>
                                    {% for context in contexts %}
                                        <li>{{ context|type }}</li>
                                    {% endfor %}
                                </ul>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
                <hr>
                {% for context in contexts %}
                    <div class="match-container">
                        <pre>{{ context | replace(search_term, '<mark>' ~ search_term ~ '</mark>') | safe }}</pre>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    {% else %}
        <p class="no-results">No matches found for "{{ search_term }}"</p>
    {% endif %}

{% endblock %}
